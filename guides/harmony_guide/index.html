<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.9">
<title data-react-helmet="true">Harmony Guide | Reactor</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:image" content="https://docs.reactor.gg/img/logo_downscaled.png"><meta data-react-helmet="true" name="twitter:image" content="https://docs.reactor.gg/img/logo_downscaled.png"><meta data-react-helmet="true" property="og:url" content="https://docs.reactor.gg/guides/harmony_guide"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="Harmony Guide | Reactor"><meta data-react-helmet="true" name="description" content="Intro to Prefixes and Postfixes"><meta data-react-helmet="true" property="og:description" content="Intro to Prefixes and Postfixes"><link data-react-helmet="true" rel="shortcut icon" href="/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://docs.reactor.gg/guides/harmony_guide"><link data-react-helmet="true" rel="alternate" href="https://docs.reactor.gg/guides/harmony_guide" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.reactor.gg/guides/harmony_guide" hreflang="x-default"><link rel="stylesheet" href="/assets/css/styles.935887a5.css">
<link rel="preload" href="/assets/js/runtime~main.fedc4d5f.js" as="script">
<link rel="preload" href="/assets/js/main.68c925ae.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"dark")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_OuoZ">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/"><div class="navbar__logo"><img src="/img/logo.png" alt="Logo" class="themedImage_TMUO themedImage--light_4Vu1"><img src="/img/logo.png" alt="Logo" class="themedImage_TMUO themedImage--dark_uzRr"></div><b class="navbar__title">Reactor</b></a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/NuclearPowered" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_iYfV toggle_2i4l toggleChecked_a04y toggleDisabled_xj38"><div class="toggleTrack_t-f2" role="button" tabindex="-1"><div class="toggleTrackCheck_mk7D"><span class="toggleIcon_pHJ9">ðŸŒœ</span></div><div class="toggleTrackX_dm8H"><span class="toggleIcon_pHJ9">ðŸŒž</span></div><div class="toggleTrackThumb_W6To"></div></div><input type="checkbox" checked="" class="toggleScreenReader_h9qa" aria-label="Switch between dark and light mode"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_lDyR"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_i9tI" type="button"></button><aside class="docSidebarContainer_0YBq"><div class="sidebar_a3j0"><nav class="menu thin-scrollbar menu_cyFh"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Quick Start</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Guides</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/bepinex_guide">BepInEx Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/guides/harmony_guide">Harmony Guide</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/debugging">Debugging</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/custom_rpcs">Custom RPCs</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/guides/custom_server">Custom server</a></li></ul></li></ul></nav></div></aside><main class="docMainContainer_r8cw"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_zHA2"><div class="docItemContainer_oiyr"><article><div class="tocCollapsible_aw-L theme-doc-toc-mobile tocMobile_Tx6Y"><button type="button" class="clean-btn tocCollapsibleButton_zr6a">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>Harmony Guide</h1></header><h2 class="anchor anchorWithStickyNavbar_y2LR" id="intro-to-prefixes-and-postfixes">Intro to Prefixes and Postfixes<a aria-hidden="true" class="hash-link" href="#intro-to-prefixes-and-postfixes" title="Direct link to heading">â€‹</a></h2><p>Harmony Patches are defined as Prefixes and Postfixes.
Extensive Harmony patch documentation is <a href="https://harmony.pardeike.net/articles/patching.html" target="_blank" rel="noopener noreferrer">here</a>.</p><p>Prefixes run before the original method. It can be used to:</p><ul><li>Access and edit the arguments of the original method.</li><li>Set the result of the original method.</li><li>Skip the original method.</li><li>One key difference to keep in mind is that while in true Harmony, patched prefixes can cancel out
other prefixes, this is <strong>NOT THE CASE</strong> with HarmonyX, the fork of Harmony that BepInEx uses.
With HarmonyX, you cannot cancel out other prefixes when returning <code>false</code> and attempting to skip the original method.<ul><li>Detailed rationale and implementation differences found here <a href="https://github.com/BepInEx/HarmonyX/wiki/Prefix-changes" target="_blank" rel="noopener noreferrer">https://github.com/BepInEx/HarmonyX/wiki/Prefix-changes</a></li></ul></li></ul><p>Postfixes run after the original method. They can be used to:</p><ul><li>Read or change the result of the original method.</li><li>Access the arguments of the original method.</li><li>Run custom code after the logic of the original method has executed.</li></ul><p>They are usually defined as <strong>attributes</strong> above a patch class,
which contains static methods named <code>Prefix</code> and/or <code>Postfix</code>. You can
access the current instance by adding a <code>__instance</code> parameter to the method (with the type
of the class you are patching).</p><ul><li>Aside from <code>__instance</code>, there are many more special parameters that can be added to the method,
such as the ability to access arguments that are passed in from the existing method. They can all
be found at <a href="https://github.com/BepInEx/HarmonyX/wiki/Patch-parameters" target="_blank" rel="noopener noreferrer">https://github.com/BepInEx/HarmonyX/wiki/Patch-parameters</a>.</li></ul><h2 class="anchor anchorWithStickyNavbar_y2LR" id="understanding-how-to-patch-classes">Understanding how to Patch Classes<a aria-hidden="true" class="hash-link" href="#understanding-how-to-patch-classes" title="Direct link to heading">â€‹</a></h2><p>An example patch is below.
In particular, we call which class we want to detect, for instance, we will use the <code>PlayerControl</code> class.
After that, we would like to define what method we want to detect in that class. In this scenario, we will
use the <code>FixedUpdate</code> method which runs every time the engine updates physics.</p><p>In order for us to patch this class and method, we can use the following line:</p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">// The type in the typeof() is the class being patched.</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">// The method in the nameof() is the method of the class that is being patched</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">[HarmonyPatch(typeof(PlayerControl), nameof(PlayerControl.FixedUpdate))]</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div><p><em>Make sure that this is above your class</em></p><p>After that, we can create a Postfix method since it is not necessary to use a Prefix
It is easy practice to make sure your method is public, static, and that your variable is called <code>__instance</code>
You then can access the <code>PlayerControl</code> from the variable <code>__instance</code></p><div class="codeBlockContainer_J+bg"><div class="codeBlockContent_csEI csharp"><pre tabindex="0" class="prism-code language-csharp codeBlock_rtdJ thin-scrollbar" style="color:#9CDCFE;background-color:#1E1E1E"><code class="codeBlockLines_1zSZ"><span class="token-line" style="color:#9CDCFE"><span class="token plain">using HarmonyLib;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain" style="display:inline-block"></span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">namespace ExampleMod</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">{</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    [HarmonyPatch(typeof(PlayerControl), nameof(PlayerControl.FixedUpdate))]</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    public static class PlayerControlPatch</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        // It is nice to know that this method runs for all players so all player&#x27;s names are changed to &quot;Apollo was here&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        public static void Postfix(PlayerControl __instance)</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        {</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            // This changes all player&#x27;s name into &quot;Apollo was here&quot;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">            __instance.nameText.Text = &quot;Apollo was here&quot;;</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">        }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">    }</span><br></span><span class="token-line" style="color:#9CDCFE"><span class="token plain">}</span><br></span></code></pre><button type="button" aria-label="Copy code to clipboard" class="copyButton_M3SB clean-btn">Copy</button></div></div></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/NuclearPowered/docs.reactor.gg/blob/master/docs/guides/harmony_guide.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_mS5F" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_mt2f"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/guides/bepinex_guide"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->BepInEx Guide</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/guides/debugging"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Debugging<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_vrFS thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#intro-to-prefixes-and-postfixes" class="table-of-contents__link toc-highlight">Intro to Prefixes and Postfixes</a></li><li><a href="#understanding-how-to-patch-classes" class="table-of-contents__link toc-highlight">Understanding how to Patch Classes</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="row footer__links"><div class="col footer__col"><div class="footer__title">Community</div><ul class="footer__items"><li class="footer__item"><a href="https://reactor.gg" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Website<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://reactor.gg/discord" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Discord<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li><li class="footer__item"><a href="https://github.com/NuclearPowered" target="_blank" rel="noopener noreferrer" class="footer__link-item"><span>Github<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_wgqa"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a></li></ul></div></div><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 NuclearPowered</div></div></div></footer></div>
<script src="/assets/js/runtime~main.fedc4d5f.js"></script>
<script src="/assets/js/main.68c925ae.js"></script>
</body>
</html>